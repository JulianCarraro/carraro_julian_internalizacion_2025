<ion-header>
  <ion-toolbar class="toolbar-financiero header-toolbar" style="--background: #f4c060;">
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/pedidos-empleado"></ion-back-button>
    </ion-buttons>
    <ion-title>{{ textos[currentLang].header }} {{ tituloTraducido }}</ion-title>
    <ion-buttons slot="end">
      <div class="language-flag" (click)="mapVisible = true">
         <img [src]="'assets/flags/' + currentLang + '.svg'" style="width: 36px;
    height: 30px;
    border-radius: 4px;" [alt]="currentLang" />
      </div>
      <ion-button (click)="logOut()">
        <ion-icon name="log-out" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="fondo-financiero">
  <div class="grafico-fondo"></div>

  <div *ngIf="isLoading" class="div-spinner">
    <ion-spinner name="circular" class="spinner-financiero" style="height: 22vh; width: 22vw;"></ion-spinner>
  </div>

  <div class="mapa-modal" *ngIf="mapVisible">
    <div class="modal-backdrop" (click)="mapVisible = false"></div>
    <div class="modal-content">
      <app-mapaidioma (idiomaSeleccionado)="cambiarIdioma($event)" (cerrar)="mapVisible = false">
      </app-mapaidioma>
    </div>
  </div>

  <div class="login-container" style="height: 100%;">
    <div class="tarjeta-login" style="height: 100%;">
      <div class="encabezado">
        <h1 class="titulo">{{ textos[currentLang].header }} {{ tituloTraducido }}</h1>
        <p class="subtitulo">{{ textos[currentLang].subtitulo }}</p>
      </div>

      <form [formGroup]="formData" class="formulario" (ngSubmit)="altaProducto()">
        <ion-item lines="none" class="item-formulario">
          <ion-label position="stacked" class="etiqueta">{{ textos[currentLang].labels.nombre }}</ion-label>
          <ion-input id="nombre" formControlName="nombre" type="text" class="input-financiero"
            [placeholder]="textos[currentLang].placeholders.nombre"></ion-input>
        </ion-item>

        <ion-item lines="none" class="item-formulario">
          <ion-label position="stacked" class="etiqueta">{{ textos[currentLang].labels.descripcion }}:</ion-label>
          <ion-input id="descripcion" formControlName="descripcion" type="text" class="input-financiero"
            [placeholder]="textos[currentLang].placeholders.descripcion"></ion-input>
        </ion-item>

        <ion-item lines="none" class="item-formulario">
          <ion-label position="stacked" class="etiqueta">{{ textos[currentLang].labels.tiempo }}:</ion-label>
          <ion-input id="tiempoElaboracion" formControlName="tiempoElaboracion" type="number" class="input-financiero"
            [placeholder]="textos[currentLang].placeholders.tiempo"></ion-input>
        </ion-item>

        <ion-item lines="none" class="item-formulario">
          <ion-label position="stacked" class="etiqueta">{{ textos[currentLang].labels.precio }}:</ion-label>
          <ion-input id="precio" formControlName="precio" type="number" class="input-financiero"
            [placeholder]="textos[currentLang].placeholders.precio"></ion-input>
        </ion-item>

        <ion-item *ngIf="userData.tipoEmpleado == 'cocinero'" class="item-formulario">
          <ion-label position="stacked">{{ textos[currentLang].labels.tipo }}</ion-label>
          <select class="native-select" formControlName="tipo" class="input-financiero"
            style="margin-top: 10px; width: 100%; height: 55px;">
            <option *ngFor="let t of textos[currentLang].tipos | keyvalue" [value]="t.key">{{ t.value }}</option>
          </select>
        </ion-item>

        <div class="photo-boxes">
          <div class="photo-box" *ngFor="let foto of fotoPreviews; let i = index" [ngClass]="{'filled': foto}">

            <img *ngIf="foto; else cameraIcon" [src]="foto" [alt]="textos[currentLang].altFoto + ' ' + (i + 1)" />

            <ng-template #cameraIcon>
              <div class="camera-icon-container">
                <ion-icon name="camera" class="camera-icon"></ion-icon>
                <div class="photo-label">{{ textos[currentLang].labels.agregarFoto }}</div>
              </div>
            </ng-template>
          </div>
        </div>


        <ion-button class="boton-alta" (click)="tomarFoto()" [disabled]="todasLasFotosCargadas">
          {{ textos[currentLang].botones.sacarFotos }}
        </ion-button>

        <ion-button type="submit" class="boton-alta" (click)="altaProducto()" [disabled]="isLoading">Guardar
          {{ textos[currentLang].botones.guardar }}</ion-button>
      </form>
    </div>
  </div>
</ion-content>